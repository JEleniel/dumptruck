{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "Dumptruck Configuration",
	"description": "Configuration schema for Dumptruck bulk data analysis system",
	"type": "object",
	"properties": {
		"$schema": {
			"type": "string",
			"description": "Path to this schema file"
		},
		"oauth": {
			"type": "object",
			"description": "OAuth 2.0/OIDC configuration (optional, all fields default to empty)",
			"properties": {
				"client_id": {
					"type": "string",
					"description": "OAuth client ID"
				},
				"client_secret": {
					"type": "string",
					"description": "OAuth client secret"
				},
				"discovery_url": {
					"type": "string",
					"description": "OIDC discovery URL for automatic configuration"
				}
			},
			"additionalProperties": false
		},
		"api_keys": {
			"type": "object",
			"description": "Configuration for external API integrations",
			"properties": {
				"hibp": {
					"type": "object",
					"description": "Have I Been Pwned (HIBP) API configuration",
					"properties": {
						"enabled": {
							"type": "boolean",
							"description": "Enable HIBP enrichment (default: false)",
							"default": false
						},
						"api_key": {
							"type": "string",
							"description": "HIBP API key (32-character hexadecimal string, required if enabled=true)"
						}
					},
					"additionalProperties": false
				}
			},
			"additionalProperties": false
		},
		"services": {
			"type": "object",
			"description": "Configuration for optional services",
			"properties": {
				"ollama": {
					"type": "object",
					"description": "Ollama service configuration for vector similarity search",
					"properties": {
						"enabled": {
							"type": "boolean",
							"description": "Enable Ollama service (default: false)",
							"default": false
						},
						"host": {
							"type": "string",
							"description": "Ollama service host (default: localhost)",
							"default": "localhost"
						},
						"port": {
							"type": "integer",
							"description": "Ollama service port (default: 11435)",
							"default": 11435,
							"minimum": 1,
							"maximum": 65535
						}
					},
					"additionalProperties": false
				}
			},
			"additionalProperties": false
		},
		"email_suffix_substitutions": {
			"type": "object",
			"description": "Email domain alias mappings for canonicalization",
			"examples": [
				{
					"gmail.com": ["googlemail.com"],
					"microsoft.com": ["outlook.com", "hotmail.com", "live.com"]
				}
			],
			"additionalProperties": {
				"type": "array",
				"items": {
					"type": "string"
				}
			}
		},
		"custom_passwords": {
			"type": "object",
			"description": "Custom plaintext passwords to check during detection",
			"properties": {
				"passwords": {
					"type": "array",
					"description": "List of plaintext passwords that will be hashed and checked",
					"items": {
						"type": "string"
					}
				}
			},
			"additionalProperties": false
		},
		"working_directory": {
			"type": "object",
			"description": "Configuration for isolated file processing and temporary storage",
			"properties": {
				"path": {
					"type": ["string", "null"],
					"description": "Absolute path to working directory (defaults to system temp if not specified)"
				},
				"verify_noexec": {
					"type": "boolean",
					"description": "Verify working directory is mounted with noexec flag (default: true)",
					"default": true
				}
			},
			"additionalProperties": false
		}
	},
	"additionalProperties": false
}
